From e64519d1ed7fd8f990f05a5562d5b5c0c44b7d7e Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Wed, 14 Jun 2017 17:10:28 +0100
Subject: [PATCH] Fix seg-fault when trying to disassemble a corrupt score
 binary.

	PR binutils/21576
	* score7-dis.c (score_opcodes): Add sentinel.

Upstream-Status: Backport
CVE: CVE-2017-9742
Signed-off-by: Armin Kuster <akuster@mvista.com>

---
 opcodes/ChangeLog    | 5 +++++
 opcodes/score7-dis.c | 3 ++-
 2 files changed, 7 insertions(+), 1 deletion(-)

Index: git/opcodes/score7-dis.c
===================================================================
--- git.orig/opcodes/score7-dis.c
+++ git/opcodes/score7-dis.c
@@ -513,7 +513,8 @@ static struct score_opcode score_opcodes
   {0x00000d05, 0x00007f0f, "tvc!"},
   {0x00000026, 0x3e0003ff, "xor\t\t%20-24r, %15-19r, %10-14r"},
   {0x00000027, 0x3e0003ff, "xor.c\t\t%20-24r, %15-19r, %10-14r"},
-  {0x00002007, 0x0000700f, "xor!\t\t%8-11r, %4-7r"}
+  {0x00002007, 0x0000700f, "xor!\t\t%8-11r, %4-7r"},
+  { 0, 0, NULL }
 };
 
 typedef struct
Index: git/opcodes/ChangeLog
===================================================================
--- git.orig/opcodes/ChangeLog
+++ git/opcodes/ChangeLog
@@ -1,3 +1,8 @@
+2017-06-14  Nick Clifton  <nickc@redhat.com>
+
+       PR binutils/21576
+       * score7-dis.c (score_opcodes): Add sentinel.
+
 2017-03-07  Alan Modra  <amodra@gmail.com>
 
 	Apply from master
